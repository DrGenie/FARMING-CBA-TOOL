<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Farming CBA Decision Tool 2</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- SheetJS (XLSX) for Excel import/export -->
  <script defer src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script defer src="app.js"></script>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">F</div>
      <div class="brand-text">
        <div class="title">Farming CBA Decision Tool 2</div>
        <div class="subtitle">Control vs treatments • auditable CBA • Excel-first</div>
      </div>
    </div>

    <div class="top-actions">
      <button class="btn ghost" data-tab-target="import">Upload / Export</button>
      <button class="btn ghost" data-tab-target="audit">Audit</button>
    </div>
  </header>

  <nav class="tabs" id="mainTabs" role="tablist" aria-label="Main tabs">
    <button class="tab active" role="tab" aria-selected="true" data-tab-target="results">Results</button>
    <button class="tab" role="tab" aria-selected="false" data-tab-target="simulations">Simulations</button>
    <button class="tab" role="tab" aria-selected="false" data-tab-target="treatments">Treatments</button>
    <button class="tab" role="tab" aria-selected="false" data-tab-target="outputs">Outputs</button>
    <button class="tab" role="tab" aria-selected="false" data-tab-target="project">Project</button>
    <button class="tab" role="tab" aria-selected="false" data-tab-target="settings">Settings</button>
    <button class="tab" role="tab" aria-selected="false" data-tab-target="ai">AI</button>
    <button class="tab" role="tab" aria-selected="false" data-tab-target="import">Upload / Export</button>
    <button class="tab" role="tab" aria-selected="false" data-tab-target="audit">Audit</button>
  </nav>

  <main class="container">
    <!-- RESULTS -->
    <section class="tab-panel active" data-tab-panel="results">
      <div class="results-header">
        <div>
          <h2>Comparison to Control</h2>
          <div class="small muted">Rows are indicators. Columns are Control + each treatment, with a Δ vs Control column for each treatment (absolute and % where meaningful).</div>
        </div>
        <div class="results-actions">
          <button class="btn" id="filterTopNpv">Top 5 by NPV</button>
          <button class="btn" id="filterTopBcr">Top 5 by BCR</button>
          <button class="btn" id="filterImprove">Only improvements vs control</button>
          <button class="btn ghost" id="filterAll">Show all</button>
          <span class="sep"></span>
          <button class="btn" id="resultsExportExcel">Export Excel</button>
          <button class="btn ghost" id="resultsPrint">Print / PDF</button>
        </div>
      </div>

      <div id="resultsMeta"></div>

      <div id="resultsLeaderboard" class="mb"></div>

      <div class="card">
        <div class="table-region">
          <div id="comparisonTableWrap" class="comparison-wrap" role="region" aria-label="Comparison to control table">
            <table id="comparisonTable" class="comparison"></table>
          </div>
        </div>

        <div class="small muted mt">
          Notes: Control is pinned and labelled “Control (baseline)”. Δ cells show absolute difference and percent where meaningful. Use “Details” to see formulas and reconciliation checks.
        </div>
      </div>
    </section>

    <!-- SIMULATIONS -->
    <section class="tab-panel" data-tab-panel="simulations" hidden>
      <div id="oneWayControls"></div>
      <div id="scenarioSets" class="mt"></div>
    </section>

    <!-- TREATMENTS -->
    <section class="tab-panel" data-tab-panel="treatments" hidden>
      <h2>Treatments</h2>
      <div class="small muted">Costs and output deltas are incremental versus Control. Capital cost is year 0. Operating components are per hectare.</div>
      <div id="treatmentsList" class="mt"></div>
    </section>

    <!-- OUTPUTS -->
    <section class="tab-panel" data-tab-panel="outputs" hidden>
      <div id="outputsList"></div>
    </section>

    <!-- PROJECT -->
    <section class="tab-panel" data-tab-panel="project" hidden>
      <div id="projectBox"></div>
    </section>

    <!-- SETTINGS -->
    <section class="tab-panel" data-tab-panel="settings" hidden>
      <div id="settingsBox"></div>
    </section>

    <!-- AI -->
    <section class="tab-panel" data-tab-panel="ai" hidden>
      <div id="aiBox"></div>
    </section>

    <!-- IMPORT / EXPORT -->
    <section class="tab-panel" data-tab-panel="import" hidden>
      <div id="importBox"></div>
    </section>

    <!-- AUDIT -->
    <section class="tab-panel" data-tab-panel="audit" hidden>
      <div id="auditBox"></div>
    </section>
  </main>

  <!-- Calculation Details Drawer -->
  <div class="drawer-backdrop" id="calcDrawerBackdrop"></div>
  <aside class="drawer" id="calcDrawer" aria-hidden="true" aria-label="Calculation details drawer">
    <div class="drawer-head">
      <div class="drawer-title" id="calcDrawerTitle">Calculation details</div>
      <button class="btn tiny ghost" id="calcDrawerClose">Close</button>
    </div>
    <div class="drawer-body" id="calcDrawerBody"></div>
  </aside>

  <div id="toast-root"></div>
</body>
</html>
