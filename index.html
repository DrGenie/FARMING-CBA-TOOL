<!-- index.html – Farming CBA Decision Tool 2 (advanced, fully functional) -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Farming CBA Decision Tool 2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="app">
  <header class="app-header">
    <div class="app-header-main">
      <div class="app-title-block">
        <div class="app-logo-circle">F</div>
        <div>
          <h1>Farming CBA Decision Tool 2</h1>
          <p>Compare long-run economic performance of farm investments</p>
        </div>
      </div>
      <div class="app-header-actions">
        <button id="btn-load-demo" type="button" class="btn btn-ghost">Load demo farm</button>
        <button id="btn-print" type="button" class="btn btn-ghost">Print</button>
      </div>
    </div>
    <div class="app-header-sub">
      <p>
        Enter present value (PV) benefits and PV costs for each treatment, or import them from Excel, then review
        the results matrix, scenario analysis, snapshots, and farmer-friendly summary.
      </p>
    </div>
  </header>

  <nav class="tabs">
    <button class="tab-button active" data-tab="inputs">1. Inputs</button>
    <button class="tab-button" data-tab="results">2. Results matrix & scenarios</button>
    <button class="tab-button" data-tab="snapshots">3. Treatment snapshots</button>
    <button class="tab-button" data-tab="excel">4. Excel, import & export</button>
    <button class="tab-button" data-tab="helper">5. Interpretation helper</button>
  </nav>

  <main class="app-main">
    <!-- Inputs panel -->
    <section id="tab-inputs" class="tab-panel active">
      <div class="card">
        <div class="card-header">
          <h2>Economic inputs by treatment</h2>
          <p>
            Each row is a treatment or strategy. Use present value (PV) benefits and PV costs for the whole analysis period
            (for example 10–20 years, discounted using your chosen rate).
          </p>
        </div>

        <div class="card-toolbar">
          <div class="toolbar-left">
            <button id="btn-add-treatment" type="button" class="btn btn-primary">Add treatment</button>
            <button id="btn-update-results" type="button" class="btn btn-secondary">Update results</button>
          </div>
          <div class="toolbar-right">
            <button id="btn-clear-all" type="button" class="btn btn-danger-outline">Clear all</button>
          </div>
        </div>

        <div class="table-wrapper">
          <table class="table">
            <thead>
            <tr>
              <th>Treatment name</th>
              <th>PV benefits<br><span class="th-sub">All years, in your currency</span></th>
              <th>PV costs<br><span class="th-sub">All years, in your currency</span></th>
              <th>Notes / description</th>
              <th></th>
            </tr>
            </thead>
            <tbody id="inputs-tbody">
            <!-- rows created by script.js -->
            </tbody>
          </table>
        </div>

        <div class="card-footer">
          <p>
            Tip: If your CBA is in Excel, sum discounted benefits and costs across years for each treatment and paste those PV totals here,
            or use the CSV import on the Excel tab to pull them in directly.
          </p>
        </div>
      </div>

      <div class="card card-narrow-top">
        <div class="card-header">
          <h2>Global assumptions</h2>
          <p>
            These are used in the interpretation text. Your PV inputs should already reflect this discount rate and analysis horizon.
          </p>
        </div>
        <div class="assumptions-grid">
          <div class="assumption-field">
            <label>Discount rate (% per year)
              <input type="number" id="discount-rate" value="7" step="0.1">
            </label>
          </div>
          <div class="assumption-field">
            <label>Analysis horizon (years)
              <input type="number" id="analysis-years" value="20" step="1">
            </label>
          </div>
          <div class="assumption-field">
            <label>Currency label
              <input type="text" id="currency-label" value="$">
            </label>
          </div>
        </div>
      </div>
    </section>

    <!-- Results matrix panel -->
    <section id="tab-results" class="tab-panel">
      <div class="card">
        <div class="card-header">
          <h2>Results matrix and scenario analysis</h2>
          <p>
            Results are ranked by net present value (NPV). You can stress-test the analysis under simple price and cost scenarios.
          </p>
        </div>

        <div class="results-toolbar">
          <div class="results-toolbar-left">
            <label class="scenario-label">
              Scenario:
              <select id="scenario-select">
                <option value="base">Base case (as entered)</option>
                <option value="lowPrice">Lower commodity prices (−20% benefits)</option>
                <option value="highCost">Higher costs (+20% costs)</option>
                <option value="optimistic">Optimistic (benefits +20%, costs −10%)</option>
              </select>
            </label>
          </div>
          <div id="results-summary" class="results-summary">
            <!-- summary text populated by script.js -->
          </div>
        </div>

        <div class="table-wrapper">
          <table class="table table-compact">
            <thead>
            <tr>
              <th>Rank</th>
              <th>Treatment</th>
              <th>PV benefits</th>
              <th>PV costs</th>
              <th>NPV</th>
              <th>Δ NPV vs baseline</th>
              <th>BCR</th>
              <th>ROI</th>
            </tr>
            </thead>
            <tbody id="results-tbody">
            <!-- rows rendered by script.js -->
            </tbody>
          </table>
        </div>

        <div class="card-footer card-footer-grid">
          <div>
            <h3>Key economic measures</h3>
            <p>
              NPV is PV benefits minus PV costs. BCR is PV benefits divided by PV costs.
              ROI is NPV divided by PV costs. A higher value usually means a stronger economic case,
              but you should also consider risk, timing, labour, and fit with the wider farm plan.
            </p>
          </div>
          <div class="note-box">
            <strong>Baseline comparison</strong>
            <p>
              The baseline is usually the control or current practice. The “Δ NPV vs baseline” column shows
              how much extra value each treatment is expected to create, in present value terms, relative to that baseline.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Treatment snapshots panel -->
    <section id="tab-snapshots" class="tab-panel">
      <div class="card">
        <div class="card-header">
          <h2>Treatment snapshots</h2>
          <p>Plain-language summaries for each treatment, based on your numbers and the selected scenario.</p>
          <p id="snapshots-scenario-label" class="scenario-label-text"></p>
        </div>

        <div id="snapshots-container" class="snapshots-grid">
          <!-- snapshot cards rendered by script.js -->
        </div>
      </div>
    </section>

    <!-- Excel & export panel -->
    <section id="tab-excel" class="tab-panel">
      <div class="card">
        <div class="card-header">
          <h2>Excel workflow, import and exports</h2>
          <p>
            Keep your detailed CBA in Excel and use this tool as a clean results front-end for decision makers.
          </p>
        </div>

        <div class="excel-layout">
          <div class="excel-step">
            <h3>1. Keep full CBA in Excel</h3>
            <p>
              Use Excel or another spreadsheet to model annual yields, prices, variable costs, and capital spending
              for each treatment. Apply your discount rate and horizon to calculate PV benefits and PV costs
              for every treatment.
            </p>
          </div>
          <div class="excel-step">
            <h3>2. Import PV totals (CSV)</h3>
            <p>
              Export a simple CSV from Excel with at least these columns:
              <strong>Treatment</strong>, <strong>PV_benefits</strong>, <strong>PV_costs</strong>, and optionally <strong>Notes</strong>.
              Then import it here to populate the inputs table automatically.
            </p>
            <input type="file" id="file-import-csv" accept=".csv" class="file-input">
            <p class="excel-tip">
              The import replaces current rows. You can still edit values manually afterwards.
            </p>
          </div>
          <div class="excel-step">
            <h3>3. Export results back to Excel</h3>
            <p>
              Export the ranked results table as a CSV file and open it in Excel or another program for
              reporting and presentations.
            </p>
            <button id="btn-export-csv" type="button" class="btn btn-primary">Download results as CSV</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Interpretation helper panel -->
    <section id="tab-helper" class="tab-panel">
      <div class="card">
        <div class="card-header">
          <h2>Farmer-friendly interpretation helper</h2>
          <p>
            This summary explains your current results, including the baseline, in everyday language.
            You can copy and adapt it for farm meetings or discussions with advisers and decision makers.
          </p>
        </div>

        <div class="helper-body">
          <textarea id="helper-text" class="helper-textarea" rows="18" readonly></textarea>
        </div>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <p>
      Farming CBA Decision Tool 2 · Use at your own discretion. Results depend on the quality of your input data and assumptions.
    </p>
  </footer>
</div>

<script src="script.js"></script>
</body>
</html>
